---
categories: 글쓰기
title: 2.1.2. 기초확률분포
created: 2025-03-19
tags:
  - 수업
  - 교재
  - 기초확률분포
---
---
# 2. *기초 확률 분포*
---

![[샘플과모집단.png]]

- 추출된 샘플의 경우의 수를 생각해 보자.

- 순열은 결국 일종의 경우의 수를 수적으로 나타낸 것으로 일정 클라스를 나열하는 순서가 있는 경우의 수를 계승 함수(factorial)
- 실제에서는 복원 비-복원 등을 고려해야 함.
- 조합은 특성이 조건에 맞춰 표출하는 표현 (일반: n개 중에)
$$
\begin{align}
	&Permutation :\ _{n}P_{r} \ = \frac{n!}{(n-r)!} \\
	\\
	&Combination :\ _{n}C_{r} = \frac{_{n}P_{r}}{r!}	
\end{align}
$$

 - 결국 모집단의 성질, 특성, 법칙, 관계 등을 알고자 하는 것이 목적이나 가진 것은 표본뿐이다. 그런데 만약에 일반적으로 형성되는 표출 형식이 있다면??? 일부분의 표본(Sample)로 모집단을 추정할 수 있지 않을까?


>[!Note] 계승 함수와 감마함수
>- Gamma($\Gamma$) 함수는 계승 함수의 연속화로 정수($\mathbb{N}$)체계를 실수($\mathbb{R}$) 범위로 확장한 개념이다.
>- 이 Gamma 함수를 적분으로 정의하면 오일러 적분이 된다.
>- $$ \Gamma(z)=\int_{0}^{\infty} t^{z-1}e^{t}dt$$


- 경우의 수가 특정한 분포를 가질 경우를 생각해 보자 즉, 발생한 또는 관찰한 회수와 관찰된 경우의 수의 비율로 가능성을 표현하는 확률로 나타낸다면 어떨까?

### 베루누이 분포

확률질량함수(PMF, Probability Mass Function)는 하나의 사건이 일어날 확률 $p$ 에 일어나는 경우 1과 일어나지 않은 경우 0 일 경우를 나타낸다. 

$$Bernoulli(x;p)=p^{x}(1−p)^{1−x}$$
$$Var(x)=p(1-p)$$

### 이항분포(Binomial Distribution)와 정규분포

- 베루누이 시행을 독립적으로 반복하여 결과를 관찰하는 경우에 나타나는 확률분포
- [Galton Board](https://www.youtube.com/watch?v=EvHiee7gs9Y), [파스칼 삼각형](https://velog.velcdn.com/images/yoochanhong/post/3b4c556d-378e-494e-ba7f-8f7f65f4c709/image.jpeg)등은 하나의 사건에 대한 두가지 경우(1,0)만 존재할 때 그 확률이 0.5로 동일할 경우 나타나는 경우이다.

$$
\begin{align}
	Binominal :\ P(x) \ &= _{n}C_{x}P^{x}(1-P)^{n-x} \\
						&= \begin{pmatrix} n \\ x\end{pmatrix}\ p^{x}(1-p)^{n-x} \\
						&= \frac{n!}{x!(n-x)!} \cdot  p^{x}(1-p)^{n-x}
\end{align}
$$

 - 이러한 Binomial 의 상태 (분포: distribution) 에서  시행(관찰) n을 매우 많이 한다면?
 - 정규(Normal: 수학 - 라플라스 => 확률변수가 정규분포) 또는 가우시안(Gaussian: 공학 - 가우스 통계오차를 정규분포의 probability Density Function으로 풀 수 있다.) 분포에 가까워진다.
- 그리고 이러한 정규분포는 자연계에서 가장 일반적인 분포의 형태이다.
	
- Brownian motion : 무작위 할 것 같은 움직임 => 아인슈타인 : 가우시안 확률 형태를 가지는 연속되는  마르코프 독립 증분 확률과정
-  경제학과 금융투자에도  이토-방정식과 블랙-슐츠 방정식으로 이를 응용하여 선물옵션 가격예측

- 대표적인 이산확률분포로 이항분포, 초기하분포, 포아송분포 등을 들 수 있다. 
	(이산확률분포는 연속확률분포로 확장, 초기하분포화 포아송분포는 지수분포로 확장된다.)
- 이항분포에서 다항분포 **(multinomial distribution)** 로 클라스가 늘어나게 되면 다음과 같이 확률질량함수를 구한다.
$$f(x_{1},x_{2},\cdots,x_{n})=\frac{n!}{x_{1}!x_{2}!\cdots x_{n}!}p_{1}^{x1}p_{2}^{x2}\cdots p_{n}^{x_{k}}$$
$$\sum_{i=1}^{k}x_{i}=n,\quad \sum_{i=1}^{k}p_{i}=1,$$

- 클라스가 연속되는 실수($\mathbb{R}$)로 확장될 때 우리는 연속확률분포라고하며, 이를 나타내는 확률함수를 확률질량함수(PDF:Probability Density Function)라고 한다.
- 전 범위에서 함수를 적분한 값은 1 이 된다.
- 이를 통해 특정 평균과 분산을 가지는 분포형태를 정규분포로 계산할 수 있게 되었다.

<정규분포>
![[정규분포.png]]

$$
\begin{align}
	&Gaussian :\ f(x) \ = \frac{1}{\sqrt{2\pi\sigma^{2}}}\ e^{-\frac{(x-\mu)^{2}}{2\sigma^{2}}}  \\
\end{align}
$$

- 이때 평균을 0 으로 분산을 1로 기준을 만들어 둔 것이 표준 정규분포(Standard Normal Distribution)이다.  따라서 분산($\sigma^{2}$)를 알면  평균($\mu : mean$)을 통해서 여러 형태의 정규분포를 알 수 있다. 이를 $Z$-분포라고 하며 확류적으로 샘플이 적은 경우를 T-분포라고 함. 
$$Z=\frac{X -\mu}{\sigma}$$
>[!Note] 데이터의 standard normalization
>- 표준 정규화라고도 하면 데이터들의 평균과 분산으로 표준 정규분포에 해당하는 데이터 범위로 변환해 주는 것을 뜻한다.


- 이때 확률 분포 함수의 측정(관측)하는  변수(특성(feature))가 연속적인(continuous)변수라고 하면 즉, 연속 확률 변수 (continuous random variable) 라 정의 내려진다면, 미소 구간의 확률로 표시하려면 어려움이 발생한다. 이를 해결하기 위해서 누적으로 확률을 표시하게 되고 있를  누적 확률 밀도 함수 (CPF:cumulative probability density function)

- 대부분의 일반적 현상이 정규분포를 따른다면 샘플을 통해서 평균과 분산을 추정할 수 있다면 모집단의 특성 즉 확률분포도 예측할 수 있지 않을까? 

#### 중심극한정리

 - 충분한 숫자(일반적으로 샘플이 30개 이상일 경우)로  중분한 횟수(150 ~ : 모집단의 크기에 의해 결정됨)만큼 반복해서 샘플을 뽑을 경우 실시한 추출 횟수가 증가할 수록  모집단이 정규분포를 따른 다른 가정 하에 점점 추출된 샘플들의 평균과 분산의 평균이 모집단이 정규분포일 경우에 평균에 가까워 진다는 정리.

	- **모집단 분포와 무관:** 모집단의 분포가 정규분포가 아니더라도, 충분히 큰 표본을 반복적으로 추출하여 표본 평균을 계산하면, 그 표본 평균들의 분포는 정규분포에 가까워짐.
	- **표본 크기 중요:** "충분한 숫자"는 일반적으로 30개 이상을 의미하지만, 모집단의 분포에 따라 더 큰 표본 크기가 필요할 수도 있음.
	- **반복 추출 중요:** "충분한 횟수"는 표본 평균의 분포가 정규분포에 수렴하는 정도를 결정합니다. 일반적으로 150회 이상 반복 추출하면 좋은 결과를 얻을 수 있음.
	- **표본 평균의 정규분포 수렴:** 추출된 표본들의 평균들의 평균은 모집단의 평균에 가까워지고, 표본 평균들의 분산은 모집단의 분산을 표본 크기로 나눈 값에 가까워짐.

>[!NOTE]  왜  세상에는 정규분포 형태가 많은 것일까?
>- 오히려 특정 독립된 확률 현상을 보인다면 정규분포를 따르지 않을 가능성이 높다.
>- 완벽한 카오스에 가까울 수록 정규분포 형태에 가깝다.
>- 브라운 운동을 찾아보자
>-  또한 이러한 완전히 무작위에 가깝다는 뜻은 일정 패턴이 없는 무-규칙의 완전한  무-작위 한 error 여야 하고 이는 특정한 정규분포 형태일 가능성이 높다.
>- 특정 예측 모델에서 오차 error 가 일정한 패턴이 없는 완전한 White Noise 일 경우 샘플에 대해서 잘 학습한 것일 수 있다. 그러나 절대적인 기준은 아니다.


#### 공분산 : covariance
:  2개의 확률 변수의 선형관계를 나타내는 값
  - 그러나 측정된 변수의 scale 에 따라서 값이 달라짐. 따라서 상관관계만을 볼때는 상관계수 사용
$$
\begin{align}
	&Cov(X,Y) \ = \frac{\sum_{i=1}^{n}(X_{i}-\bar X)\cdot(Y_{i}-\bar Y)}{n-1}  \\
\end{align}
$$
#### 상관계수 : correlation coefficient
: 2개의 변수 사이의 통계적 관계를 표현 위한 상관 관계의 정도를 수치로 표현한 계수
##### Pearson Correlation Coefficient, PCC 피어슨 상관계수
: 피어슨 상관계수의 제곱이 결정계수가 된다. (**결정계수 $R^{2}$는 회귀관계의 적합정도 또는 설명력을 뜻한다.** )

$$
\begin{align}
	R(X,Y) \ &= \frac{\frac{\sum_{i=1}^{n}(X_{i}-\bar X)\cdot(Y_{i}-\bar Y)}{n-1}}{\sqrt{\frac{\sum_{i=1}^{n}(X_{i}-\bar X)^{2}}{n-1}}\cdot \sqrt{\frac{\sum_{i=1}^{n}(Y_{i}-\bar Y)^{2}}{n-1}}}  \\ \\
			&= \frac{COV(X,Y)}{STD(X)\cdot STD(Y)}
\end{align}
$$
![[상관계수.png]]


### 주요 기초통계 검정

- 모집단 (또는 귀무가설 또는 사전확률) 에 대한 표본통계량(데이터 샘플)이 가지는 의미를 검정
- 기본이 되는 검정이 평균(기댓값)에 대한 검증
##### 스튜어트 T-test 
- 두 집단 간 평균 차이에 대한 검정 : 표준오차와 표본평균사이의 차이
	**검정 통계량 : T-value**  와 T - 분포
	![[T_value.png]]
$$
\begin{align}
	&t = \frac{\bar x - \mu_{0}}{s/\sqrt{n}} \\ \\
	
	&t = \frac{(\bar x_{1} - \bar x_{2} )-(\mu_{1}-\mu_{2})}
	{\sqrt{
			\frac{s_{1}^{2}}{n_{1}}
		   +\frac{s_{2}^{2}}{n_{2}}
		 }
	 }
\end{align}
$$

##### ANOVA 분산 분석 (one-way ANOVA)
- 세 집단 이상 간에 대한 검정
	**검정 통계량 : F-value** 와 F - 분포 :  F 값은  표본 평균 간 변동 / 표본 내 변동 . 즉, 둘의 비율이다.
	![[F_value.png]]

- 또는 어떤 상태 변화가 특정 요인의 영향 수준에 의한 변동성의 효과와 그 외의 효과로 변동성을 분해하는 것으로 볼 수도 있다.

bet df1: 자유도는 구릅의 수 - 1 , 전체의 평균으로 
wit df2: 전체 샘플 개수 - 그룹의 개수, 각 구릅의 평균
두개의 자유도를 합치면 t-test의 자유도

$$
\begin{align}
	&F\  value = \frac{Between\ \ variance(SS_{between})}{Within\ \ variance(SS_{within})} \\ \\

	&\sum_{i=1}^{a}\sum_{j=1}^{N}(y_{ij}-\bar y)^{2} = 
	\sum_{i=1}^{a}\sum_{j=1}^{N}(y_{i}-\bar y)^{2} +
	\sum_{i=1}^{a}\sum_{j=1}^{N}(y_{ij}-\bar y_{i})^{2} \\ \\
	& SST = SS_{tr}+SSE

\end{align}
$$
a: 수준, i : 색인

![[일원분산분석표.png]]
https://en.wikipedia.org/wiki/F-test


##### $\chi^{2}$ 검정  
-  k개의 서로 독립적인 표준정규 확률변수를 각각 제곱한 다음 합해서 얻어지는 분포
- 오차(error) or 편차(deviation) 분석	
	**검정 통계량 : $\chi^{2}$** 와 $\chi^{2}$ - 분포
	e : 기대도수
	n : 관찰값 
	df : 자유도
$$
\begin{align}
	&\chi^{2} = \sum_{i=1}^{r}\sum_{j=1}^{c}\frac{(n_{ij}-e{ij})^{2}}{e_{ij}} \\ \\
	&e_{ij} = \frac{n_{i}\times n_{j}}{N} \\ \\
	& df = (r -1)(c-1) : row = 1 : df = (r-1)
\end{align}
$$
  검정 통계량이 유의수준, 자유도의 카이분포 값의 기각역 인상이면 귀무가설 기각

1) 적합도 검정(goodness of fit) : 한 범주형 변수의 각 그룹별 비율이 특정 비율과 같은지 검정
2) 동질성 검정(Test of Homogeneity) : 부모집단에 대해 열 변수의 분포가 동질 한지 검정
3) 독립성 검정(Test of Independence) : 조사 대상을 고정한 뒤, 조사 결과를 바탕으로 두 범주형 변수 간 연관관계가 유의한지 검정

